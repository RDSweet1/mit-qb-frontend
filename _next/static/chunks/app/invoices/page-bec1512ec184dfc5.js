(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[760],{82575:function(e,t,s){Promise.resolve().then(s.bind(s,99939))},99939:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var r=s(57437),n=s(2265),i=s(32660),l=s(95252),a=s(31047),c=s(65302),o=s(48736),d=s(27648),h=s(93303),u=s(945),m=s(2085),x=s(27742);function p(){let[e,t]=(0,n.useState)(!1),[s,p]=(0,n.useState)(!1),[y,g]=(0,n.useState)(null),[f,b]=(0,n.useState)(null),[j,v]=(0,n.useState)(()=>{let e=(0,u.W)(new Date,1);return(0,m.WU)(e,"yyyy-MM")}),N=async()=>{try{t(!0),g(null),p(!1),b(null);let e=new Date(j+"-01"),s=(0,x.V)(e),r=await (0,h.i)("create-invoices",{month:(0,m.WU)(e,"yyyy-MM"),monthStart:(0,m.WU)(e,"yyyy-MM-dd"),monthEnd:(0,m.WU)(s,"yyyy-MM-dd")});b(r),p(!0)}catch(e){g(e instanceof Error?e.message:"Failed to create invoices")}finally{t(!1)}};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(d.default,{href:"/",className:"text-gray-600 hover:text-gray-900",children:(0,r.jsx)(i.Z,{className:"w-6 h-6"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Monthly Invoices"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Create invoices in QuickBooks Online"})]})]})})}),(0,r.jsxs)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(l.Z,{className:"w-6 h-6 text-purple-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Create Monthly Invoices"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Generate invoices for all customers with billable time"})]})]}),(0,r.jsxs)("div",{className:"mb-6 p-4 bg-purple-50 border border-purple-200 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold text-purple-900 mb-2",children:"Invoice Generation Process:"}),(0,r.jsxs)("ul",{className:"text-sm text-purple-800 space-y-1 list-disc list-inside",children:[(0,r.jsx)("li",{children:"Retrieves all billable time entries for the selected month"}),(0,r.jsx)("li",{children:"Groups hours by customer and service item"}),(0,r.jsx)("li",{children:"Creates invoices directly in QuickBooks Online"}),(0,r.jsx)("li",{children:"Uses service item rates from QuickBooks for accurate billing"}),(0,r.jsx)("li",{children:"Skips customers with zero billable hours"})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{htmlFor:"monthSelect",className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Billing Month"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(a.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,r.jsx)("input",{type:"month",id:"monthSelect",value:j,onChange:e=>v(e.target.value),className:"pl-10 w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,r.jsxs)("p",{className:"mt-2 text-sm text-gray-500",children:["Period: ",(0,m.WU)(new Date(j+"-01"),"MMMM yyyy")]})]}),y&&(0,r.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-red-800",children:y})}),s&&f&&(0,r.jsx)("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(c.Z,{className:"w-5 h-5 text-green-600 mt-0.5"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-green-800 font-medium mb-2",children:"Invoices created successfully!"}),(0,r.jsxs)("div",{className:"text-sm text-green-700",children:[(0,r.jsxs)("p",{children:["• Created: ",f.created||0," invoices"]}),(0,r.jsxs)("p",{children:["• Skipped: ",f.skipped||0," customers (no billable hours)"]}),f.errors&&f.errors.length>0&&(0,r.jsxs)("p",{className:"text-red-600",children:["• Errors: ",f.errors.length]})]})]})]})}),(0,r.jsx)("button",{onClick:N,disabled:e,className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg font-semibold hover:from-purple-600 hover:to-purple-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"spinner w-5 h-5 border-2"}),"Creating invoices..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:"w-5 h-5"}),"Create Monthly Invoices"]})}),(0,r.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Important Notes:"}),(0,r.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,r.jsx)("li",{children:"• Invoices are created in QuickBooks Online immediately"}),(0,r.jsx)("li",{children:"• You can review and edit invoices in QuickBooks before sending"}),(0,r.jsx)("li",{children:"• Duplicate invoices are prevented by checking existing records"}),(0,r.jsx)("li",{children:"• All invoice creation is logged for accounting records"})]})]})]}),(0,r.jsxs)("div",{className:"mt-8 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Invoice Preview"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 text-center py-8",children:"Preview will show estimated invoice details before creation..."})]})]})]})}},93303:function(e,t,s){"use strict";s.d(t,{O:function(){return l},i:function(){return a}});var r=s(13053);let n="https://migcpasmtbdojqphqyzc.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1pZ2NwYXNtdGJkb2pxcGhxeXpjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2OTk3MjYsImV4cCI6MjA4NTI3NTcyNn0.90w8O2oX76uPTuFp092jTCZoL95lJ7YnaOPMGcRP2fQ",l=(0,r.eI)(n,i);async function a(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",r="".concat(n,"/functions/v1/").concat(e),l=await fetch(r,{method:s,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i)},body:t?JSON.stringify(t):void 0});if(!l.ok){let e=await l.text();throw Error("Edge Function error: ".concat(e))}return l.json()}},32660:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(39763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},31047:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(39763).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},65302:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(39763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},95252:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(39763).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},48736:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(39763).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},27742:function(e,t,s){"use strict";s.d(t,{V:function(){return n}});var r=s(99649);function n(e){let t=(0,r.Q)(e),s=t.getMonth();return t.setFullYear(t.getFullYear(),s+1,0),t.setHours(23,59,59,999),t}},945:function(e,t,s){"use strict";s.d(t,{W:function(){return i}});var r=s(99649),n=s(63497);function i(e,t){return function(e,t){let s=(0,r.Q)(e);if(isNaN(t))return(0,n.L)(e,NaN);if(!t)return s;let i=s.getDate(),l=(0,n.L)(e,s.getTime());return(l.setMonth(s.getMonth()+t+1,0),i>=l.getDate())?l:(s.setFullYear(l.getFullYear(),l.getMonth(),i),s)}(e,-t)}}},function(e){e.O(0,[641,85,971,117,744],function(){return e(e.s=82575)}),_N_E=e.O()}]);